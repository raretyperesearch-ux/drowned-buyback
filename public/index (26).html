<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DROWNED | What Is Dead May Never Die</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ”¥</text></svg>">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0a0a0f; color: #fff; min-height: 100vh; overflow-x: hidden; }

    /* ANIMATED BACKGROUND */
    .background-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
    .background-image { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.55) contrast(1.1) saturate(0.8); }
    .pulse-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(ellipse at center, transparent 0%, rgba(0, 10, 20, 0.4) 100%); animation: pulse 8s ease-in-out infinite; }
    @keyframes pulse { 0%, 100% { opacity: 0.4; } 50% { opacity: 0.7; } }
    #snow-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
    .mist { position: absolute; width: 200%; height: 100%; background: linear-gradient(90deg, transparent 0%, rgba(180, 200, 220, 0.03) 20%, rgba(180, 200, 220, 0.06) 50%, rgba(180, 200, 220, 0.03) 80%, transparent 100%); animation: drift 30s linear infinite; }
    .mist-1 { top: 30%; animation-duration: 35s; opacity: 0.7; }
    .mist-2 { top: 50%; animation-duration: 45s; animation-delay: -15s; opacity: 0.5; }
    .mist-3 { top: 70%; animation-duration: 25s; animation-delay: -8s; opacity: 0.6; }
    @keyframes drift { 0% { transform: translateX(-50%); } 100% { transform: translateX(0%); } }
    .vignette { position: absolute; top: 0; left: 0; width: 100%; height: 100%; box-shadow: inset 0 0 200px 100px rgba(0, 0, 0, 0.7); pointer-events: none; }
    .dark-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(180deg, rgba(10, 10, 15, 0.4) 0%, rgba(10, 10, 15, 0.2) 50%, rgba(10, 10, 15, 0.5) 100%); pointer-events: none; }

    /* NAVIGATION */
    nav { display: flex; justify-content: space-between; align-items: center; padding: 1.5rem 4rem; position: relative; z-index: 100; background: rgba(10, 10, 15, 0.4); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
    .logo { display: flex; align-items: center; gap: 0.75rem; font-weight: 700; font-size: 1.25rem; letter-spacing: 1px; }
    .logo-icon { font-size: 1.5rem; }
    .nav-links { display: flex; gap: 2.5rem; }
    .nav-links a { color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9rem; transition: color 0.3s; }
    .nav-links a:hover { color: #fff; }
    .launch-btn { background: linear-gradient(135deg, #8b5cf6, #a855f7); color: white; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 500; font-size: 0.9rem; transition: all 0.3s; border: none; cursor: pointer; }
    .launch-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(139, 92, 246, 0.4); }

    .content { position: relative; z-index: 10; }

    /* HERO */
    .hero { text-align: center; padding: 4rem 2rem 3rem; }
    .status-badge { display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(255, 255, 255, 0.1); padding: 0.5rem 1rem; border-radius: 50px; font-size: 0.85rem; margin-bottom: 2rem; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
    .status-dot { width: 8px; height: 8px; background: #22c55e; border-radius: 50%; animation: blink 2s infinite; }
    @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    h1 { font-size: 4.5rem; font-weight: 400; letter-spacing: 8px; margin-bottom: 0.5rem; text-transform: uppercase; font-family: 'Times New Roman', serif; text-shadow: 0 0 60px rgba(139, 92, 246, 0.3); }
    .tagline { font-size: 1rem; letter-spacing: 6px; color: rgba(255, 255, 255, 0.5); margin-bottom: 2rem; text-transform: uppercase; }
    .description { max-width: 600px; margin: 0 auto 2.5rem; color: rgba(255, 255, 255, 0.7); line-height: 1.7; font-size: 1.05rem; }
    .hero-buttons { display: flex; justify-content: center; gap: 1rem; margin-bottom: 3rem; }
    .btn-primary { background: linear-gradient(135deg, #8b5cf6, #a855f7); color: white; padding: 1rem 2rem; border-radius: 8px; font-weight: 600; transition: all 0.3s; border: none; cursor: pointer; font-size: 1rem; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(139, 92, 246, 0.5); }
    .btn-secondary { background: rgba(255, 255, 255, 0.1); color: white; padding: 1rem 2rem; border-radius: 8px; font-weight: 500; transition: all 0.3s; border: 1px solid rgba(255, 255, 255, 0.2); cursor: pointer; font-size: 1rem; }
    .btn-secondary:hover { background: rgba(255, 255, 255, 0.15); }

    /* TABS */
    .tabs { display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 3rem; background: rgba(255, 255, 255, 0.05); padding: 0.5rem; border-radius: 12px; width: fit-content; margin-left: auto; margin-right: auto; backdrop-filter: blur(10px); }
    .tab { padding: 0.75rem 1.5rem; border-radius: 8px; cursor: pointer; transition: all 0.3s; color: rgba(255, 255, 255, 0.6); font-weight: 500; border: none; background: transparent; font-size: 0.95rem; }
    .tab:hover { color: #fff; }
    .tab.active { background: linear-gradient(135deg, #8b5cf6, #a855f7); color: white; }

    /* STATS */
    .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.5rem; max-width: 1200px; margin: 0 auto; padding: 0 2rem 4rem; }
    .stat-card { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); padding: 1.5rem; border-radius: 16px; border: 1px solid rgba(255, 255, 255, 0.05); }
    .stat-label { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; color: rgba(255, 255, 255, 0.5); margin-bottom: 0.5rem; }
    .stat-value { font-size: 2rem; font-weight: 700; }
    .stat-value.green { color: #22c55e; }
    .stat-value.orange { color: #f97316; }
    .stat-value.purple { color: #a855f7; }

    /* TAB PANELS */
    .tab-panel { display: none; max-width: 1200px; margin: 0 auto; padding: 0 2rem 4rem; }
    .tab-panel.active { display: block; }

    /* SEARCH */
    .search-container { margin-bottom: 2rem; }
    .search-box { display: flex; gap: 1rem; max-width: 500px; }
    .search-input { flex: 1; padding: 1rem 1.5rem; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: #fff; font-size: 1rem; }
    .search-input:focus { outline: none; border-color: #8b5cf6; }
    .search-input::placeholder { color: rgba(255, 255, 255, 0.4); }
    .search-btn { padding: 1rem 1.5rem; background: linear-gradient(135deg, #8b5cf6, #a855f7); border: none; border-radius: 8px; color: white; font-weight: 600; cursor: pointer; }
    .search-result { margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.03); border-radius: 8px; display: none; }
    .search-result.show { display: block; }
    .search-result.found { border: 1px solid rgba(34, 197, 94, 0.3); background: rgba(34, 197, 94, 0.1); }
    .search-result.not-found { border: 1px solid rgba(239, 68, 68, 0.3); background: rgba(239, 68, 68, 0.1); }

    /* REGISTERED PROJECTS */
    .projects-section { margin-bottom: 3rem; }
    .projects-section h2 { font-size: 1.25rem; margin-bottom: 1rem; font-weight: 600; }
    .projects-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1rem; }
    .project-card { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); padding: 1.25rem; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.05); transition: all 0.3s; }
    .project-card:hover { border-color: rgba(139, 92, 246, 0.3); transform: translateY(-2px); }
    .project-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
    .project-name { font-size: 1.1rem; font-weight: 600; color: #fff; }
    .project-ticker { color: #a855f7; font-weight: 600; font-size: 0.9rem; }
    .project-status { padding: 0.25rem 0.75rem; border-radius: 50px; font-size: 0.7rem; font-weight: 600; text-transform: uppercase; background: rgba(34, 197, 94, 0.2); color: #22c55e; }
    .project-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem; }
    .project-stat { background: rgba(0, 0, 0, 0.2); padding: 0.75rem; border-radius: 8px; }
    .project-stat-label { font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.5px; color: rgba(255, 255, 255, 0.5); margin-bottom: 0.25rem; }
    .project-stat-value { font-size: 1rem; font-weight: 700; color: #22c55e; }
    .project-stat-value.orange { color: #f97316; }
    .project-mint { font-family: monospace; font-size: 0.75rem; color: rgba(255, 255, 255, 0.5); word-break: break-all; padding: 0.5rem; background: rgba(0, 0, 0, 0.2); border-radius: 6px; }
    .project-mint a { color: rgba(255, 255, 255, 0.5); text-decoration: none; }
    .project-mint a:hover { color: #8b5cf6; }

    /* BURNS */
    .burns-section { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
    .burns-column h2 { font-size: 1.25rem; margin-bottom: 1rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem; }
    .live-indicator { width: 8px; height: 8px; background: #ef4444; border-radius: 50%; animation: live-pulse 1.5s infinite; }
    @keyframes live-pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.5; transform: scale(1.2); } }
    .burns-table { width: 100%; background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); border-radius: 16px; overflow: hidden; border: 1px solid rgba(255, 255, 255, 0.05); }
    .burns-table table { width: 100%; border-collapse: collapse; }
    .burns-table th { text-align: left; padding: 1rem 1.25rem; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; color: rgba(255, 255, 255, 0.5); background: rgba(0, 0, 0, 0.2); border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
    .burns-table td { padding: 0.875rem 1.25rem; border-bottom: 1px solid rgba(255, 255, 255, 0.05); font-size: 0.85rem; }
    .burns-table tr:last-child td { border-bottom: none; }
    .burns-table tr:hover { background: rgba(255, 255, 255, 0.02); }
    .burns-table a { color: #8b5cf6; text-decoration: none; }
    .empty-state { text-align: center; padding: 3rem 2rem; color: rgba(255, 255, 255, 0.5); }
    .burn-new { animation: highlight 2s ease-out; }
    @keyframes highlight { 0% { background: rgba(139, 92, 246, 0.3); } 100% { background: transparent; } }

    /* REGISTER */
    .register-section { max-width: 500px; margin: 0 auto; }
    .register-section h2 { font-size: 1.5rem; margin-bottom: 0.5rem; font-weight: 600; text-align: center; }
    .register-section .subtitle { color: rgba(255, 255, 255, 0.6); margin-bottom: 2rem; text-align: center; }
    .form-card { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); padding: 2rem; border-radius: 16px; border: 1px solid rgba(255, 255, 255, 0.05); }
    .form-group { margin-bottom: 1.5rem; }
    .form-group label { display: block; font-size: 0.85rem; color: rgba(255, 255, 255, 0.7); margin-bottom: 0.5rem; }
    .form-group input { width: 100%; padding: 1rem; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: #fff; font-size: 1rem; }
    .form-group input:focus { outline: none; border-color: #8b5cf6; }
    .form-group input::placeholder { color: rgba(255, 255, 255, 0.3); }
    .submit-btn { width: 100%; padding: 1rem; background: linear-gradient(135deg, #8b5cf6, #a855f7); color: white; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; }
    .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(139, 92, 246, 0.5); }
    .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .success-box { margin-top: 1.5rem; padding: 1.5rem; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 12px; display: none; }
    .success-box.show { display: block; }
    .success-box p { color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem; }
    .deposit-address { display: flex; align-items: center; gap: 0.5rem; background: rgba(0, 0, 0, 0.3); padding: 1rem; border-radius: 8px; font-family: monospace; font-size: 0.9rem; word-break: break-all; }
    .copy-btn { background: linear-gradient(135deg, #8b5cf6, #a855f7); color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-weight: 500; white-space: nowrap; }

    /* HOW IT WORKS */
    .how-section h2 { font-size: 1.5rem; margin-bottom: 2rem; font-weight: 600; text-align: center; }
    .steps-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem; }
    .step-card { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); padding: 2rem; border-radius: 16px; border: 1px solid rgba(255, 255, 255, 0.05); text-align: center; }
    .step-number { width: 50px; height: 50px; background: linear-gradient(135deg, #8b5cf6, #a855f7); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; font-weight: 700; margin: 0 auto 1.5rem; }
    .step-card h3 { font-size: 1.1rem; margin-bottom: 0.75rem; }
    .step-card p { color: rgba(255, 255, 255, 0.6); line-height: 1.6; font-size: 0.95rem; }
    .fee-info { margin-top: 3rem; padding: 2rem; background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.2); border-radius: 16px; text-align: center; }
    .fee-info h3 { font-size: 1.25rem; margin-bottom: 1rem; color: #a855f7; }
    .fee-info p { color: rgba(255, 255, 255, 0.7); line-height: 1.7; }

    /* RESPONSIVE */
    @media (max-width: 900px) {
      nav { padding: 1rem 2rem; }
      .nav-links { display: none; }
      h1 { font-size: 2.5rem; letter-spacing: 4px; }
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
      .steps-grid, .burns-section { grid-template-columns: 1fr; }
      .projects-grid { grid-template-columns: 1fr; }
    }
    @media (max-width: 600px) {
      .stats-grid { grid-template-columns: 1fr; }
      .hero-buttons, .search-box { flex-direction: column; }
    }
  </style>
</head>
<body>
  <div class="background-container">
    <img src="/john_snow.jpg" alt="" class="background-image">
    <div class="dark-overlay"></div>
    <div class="pulse-overlay"></div>
    <div class="mist mist-1"></div>
    <div class="mist mist-2"></div>
    <div class="mist mist-3"></div>
    <canvas id="snow-canvas"></canvas>
    <div class="vignette"></div>
  </div>

  <div class="content">
    <nav>
      <div class="logo"><span class="logo-icon">ðŸ”¥</span><span>DROWNED</span></div>
      <div class="nav-links">
        <a href="#" onclick="showTab('dashboard')">Dashboard</a>
        <a href="#" onclick="showTab('register')">Register</a>
        <a href="#" onclick="showTab('how')">How It Works</a>
      </div>
      <button class="launch-btn" onclick="showTab('register')">Launch App</button>
    </nav>

    <section class="hero">
      <div class="status-badge"><span class="status-dot"></span>Live on Solana Mainnet</div>
      <h1>WHAT IS DEAD</h1>
      <p class="tagline">M A Y &nbsp; N E V E R &nbsp; D I E</p>
      <p class="description">Automatic buyback & burn as a service. Point your pump.fun fees at us, we convert them to buy pressure and reduce your supply. Forever.</p>
      <div class="hero-buttons">
        <button class="btn-primary" onclick="showTab('register')">Register Your Token</button>
        <button class="btn-secondary" onclick="showTab('how')">Learn More</button>
      </div>
      <div class="tabs">
        <button class="tab active" data-tab="dashboard" onclick="showTab('dashboard')">Dashboard</button>
        <button class="tab" data-tab="register" onclick="showTab('register')">Register</button>
        <button class="tab" data-tab="how" onclick="showTab('how')">How It Works</button>
      </div>
    </section>

    <div class="stats-grid">
      <div class="stat-card"><div class="stat-label">Active Projects</div><div class="stat-value" id="project-count">0</div></div>
      <div class="stat-card"><div class="stat-label">SOL Processed</div><div class="stat-value green" id="sol-processed">0 SOL</div></div>
      <div class="stat-card"><div class="stat-label">Total Burns</div><div class="stat-value orange" id="total-burns">0</div></div>
      <div class="stat-card"><div class="stat-label">$DROWNED Burned</div><div class="stat-value purple" id="drowned-burned">0</div></div>
    </div>

    <div class="tab-panel active" id="panel-dashboard">
      <div class="search-container">
        <div class="search-box">
          <input type="text" class="search-input" id="search-input" placeholder="Search by token name, ticker, or mint address...">
          <button class="search-btn" onclick="searchProject()">Search</button>
        </div>
        <div class="search-result" id="search-result"></div>
      </div>

      <div class="projects-section">
        <h2>ðŸ“‹ Registered Projects</h2>
        <div class="projects-grid" id="projects-grid">
          <div class="empty-state"><p>No projects registered yet</p></div>
        </div>
      </div>

      <div class="burns-section">
        <div class="burns-column">
          <h2><span class="live-indicator"></span> Live Burns</h2>
          <div class="burns-table">
            <table>
              <thead><tr><th>Token</th><th>Burned</th><th>SOL</th><th>Time</th><th>TX</th></tr></thead>
              <tbody id="live-burns-body"><tr><td colspan="5" class="empty-state"><p>Waiting for burns...</p></td></tr></tbody>
            </table>
          </div>
        </div>
        <div class="burns-column">
          <h2>ðŸ”¥ All Burns</h2>
          <div class="burns-table">
            <table>
              <thead><tr><th>Token</th><th>Burned</th><th>SOL</th><th>Time</th><th>TX</th></tr></thead>
              <tbody id="all-burns-body"><tr><td colspan="5" class="empty-state"><p>No burns yet</p></td></tr></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-panel" id="panel-register">
      <div class="register-section">
        <h2>Register Your Token</h2>
        <p class="subtitle">Get your unique deposit address for automatic buyback & burn</p>
        <div class="form-card">
          <form id="register-form">
            <div class="form-group"><label>Token Mint Address (CA)</label><input type="text" id="token-mint" placeholder="Enter your token's mint address" required></div>
            <div class="form-group"><label>Token Name</label><input type="text" id="token-name" placeholder="e.g. My Token"></div>
            <div class="form-group"><label>Token Ticker</label><input type="text" id="token-ticker" placeholder="e.g. $TOKEN"></div>
            <div class="form-group"><label>Your Wallet Address</label><input type="text" id="owner-wallet" placeholder="Your Solana wallet address" required></div>
            <button type="submit" class="submit-btn">Receive Your Deposit Address</button>
          </form>
          <div class="success-box" id="success-box">
            <p>âœ… Success! Send your pump.fun fees to:</p>
            <div class="deposit-address"><span id="deposit-address"></span><button class="copy-btn" onclick="copyAddress()">Copy</button></div>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-panel" id="panel-how">
      <div class="how-section">
        <h2>How It Works</h2>
        <div class="steps-grid">
          <div class="step-card"><div class="step-number">1</div><h3>Register Your Token</h3><p>Enter your token's mint address and get a unique deposit wallet for your project.</p></div>
          <div class="step-card"><div class="step-number">2</div><h3>Send Fees</h3><p>Point your pump.fun trading fees to your deposit address. Works with any SOL source.</p></div>
          <div class="step-card"><div class="step-number">3</div><h3>Automatic Burns</h3><p>We automatically buy your token and send it to the burn address. Supply goes down forever.</p></div>
        </div>
        <div class="fee-info"><h3>Platform Fee: 2%</h3><p>98% of deposited SOL buys & burns YOUR token.<br>2% buys & burns $DROWNED, supporting the platform.</p></div>
      </div>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('snow-canvas');
    const ctx = canvas.getContext('2d');
    let width, height, snowflakes = [];
    const SNOWFLAKE_COUNT = 150;

    function resize() { width = canvas.width = window.innerWidth; height = canvas.height = window.innerHeight; }
    function createSnowflake() { return { x: Math.random() * width, y: Math.random() * height - height, radius: Math.random() * 2.5 + 0.5, speed: Math.random() * 0.8 + 0.2, wind: Math.random() * 0.5 - 0.25, opacity: Math.random() * 0.6 + 0.2, swing: Math.random() * Math.PI * 2, swingSpeed: Math.random() * 0.02 + 0.01 }; }
    function initSnowflakes() { snowflakes = []; for (let i = 0; i < SNOWFLAKE_COUNT; i++) { const f = createSnowflake(); f.y = Math.random() * height; snowflakes.push(f); } }
    function updateSnowflakes() { for (let f of snowflakes) { f.y += f.speed; f.swing += f.swingSpeed; f.x += f.wind + Math.sin(f.swing) * 0.3; if (f.y > height + 10) { f.y = -10; f.x = Math.random() * width; } if (f.x > width + 10) f.x = -10; if (f.x < -10) f.x = width + 10; } }
    function drawSnowflakes() { ctx.clearRect(0, 0, width, height); for (let f of snowflakes) { ctx.beginPath(); ctx.arc(f.x, f.y, f.radius, 0, Math.PI * 2); ctx.fillStyle = `rgba(220, 235, 250, ${f.opacity})`; ctx.fill(); } }
    function animateSnow() { updateSnowflakes(); drawSnowflakes(); requestAnimationFrame(animateSnow); }
    resize(); initSnowflakes(); animateSnow();
    window.addEventListener('resize', () => { resize(); initSnowflakes(); });

    function showTab(tabName) {
      document.querySelectorAll('.tab').forEach(t => { t.classList.remove('active'); if (t.dataset.tab === tabName) t.classList.add('active'); });
      document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
      document.getElementById(`panel-${tabName}`).classList.add('active');
    }

    let allProjects = [];

    async function searchProject() {
      const query = document.getElementById('search-input').value.trim().toLowerCase();
      const resultDiv = document.getElementById('search-result');
      if (!query) { resultDiv.classList.remove('show'); return; }
      const found = allProjects.find(p => p.token_name?.toLowerCase().includes(query) || p.token_ticker?.toLowerCase().includes(query) || p.token_mint?.toLowerCase().includes(query));
      if (found) {
        resultDiv.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center;"><div><strong style="color:#22c55e;">âœ“ Found!</strong><br><span style="font-size:1.1rem;font-weight:600;">${found.token_ticker || found.token_name}</span><br><span style="color:rgba(255,255,255,0.6);font-size:0.85rem;">Total Burned: ${formatNumber(found.total_tokens_burned || 0)} tokens</span></div><div style="text-align:right;"><span style="color:#22c55e;font-size:1.5rem;font-weight:700;">${parseFloat(found.total_sol_received || 0).toFixed(2)} SOL</span><br><span style="color:rgba(255,255,255,0.5);font-size:0.8rem;">processed</span></div></div>`;
        resultDiv.className = 'search-result show found';
      } else {
        resultDiv.innerHTML = `<strong style="color:#ef4444;">âœ— Not Found</strong><br><span style="color:rgba(255,255,255,0.6);">No project matches "${query}". <a href="#" onclick="showTab('register')" style="color:#8b5cf6;">Register it?</a></span>`;
        resultDiv.className = 'search-result show not-found';
      }
    }
    document.getElementById('search-input').addEventListener('keypress', e => { if (e.key === 'Enter') searchProject(); });

    let lastBurnId = null;

    async function loadDashboard() {
      try {
        const res = await fetch('/api/dashboard');
        const data = await res.json();
        document.getElementById('project-count').textContent = data.overview?.totalProjects || 0;
        const totalSol = data.projects?.reduce((sum, p) => sum + (p.total_sol_received || 0), 0) || 0;
        document.getElementById('sol-processed').textContent = totalSol.toFixed(2) + ' SOL';
        document.getElementById('total-burns').textContent = data.overview?.totalBurns || 0;
        document.getElementById('drowned-burned').textContent = formatNumber(data.platformStats?.totalPlatformBurned || 0);
        if (data.projects) { allProjects = data.projects; renderProjects(data.projects); }
        if (data.recentBurns && data.recentBurns.length > 0) {
          document.getElementById('all-burns-body').innerHTML = data.recentBurns.map(b => `<tr><td>${b.token_ticker || b.token_name || 'Unknown'}</td><td>${formatNumber(b.tokens_burned)}</td><td>${parseFloat(b.sol_spent || 0).toFixed(3)}</td><td>${timeAgo(b.created_at)}</td><td><a href="https://solscan.io/tx/${b.burn_signature}" target="_blank">View</a></td></tr>`).join('');
          const newest = data.recentBurns[0];
          if (lastBurnId && newest.burn_signature !== lastBurnId) addToLiveFeed(newest);
          lastBurnId = newest.burn_signature;
        }
      } catch (e) { console.log('Dashboard error:', e); }
    }

    function renderProjects(projects) {
      const grid = document.getElementById('projects-grid');
      if (!projects || projects.length === 0) { grid.innerHTML = `<div class="empty-state"><p>No projects registered yet</p></div>`; return; }
      grid.innerHTML = projects.map(p => `<div class="project-card"><div class="project-header"><div><div class="project-name">${p.token_name || 'Unnamed'}</div><div class="project-ticker">${p.token_ticker || ''}</div></div><span class="project-status">Active</span></div><div class="project-stats"><div class="project-stat"><div class="project-stat-label">SOL Received</div><div class="project-stat-value">${parseFloat(p.total_sol_received || 0).toFixed(3)}</div></div><div class="project-stat"><div class="project-stat-label">Tokens Burned</div><div class="project-stat-value orange">${formatNumber(p.total_tokens_burned || 0)}</div></div></div><div class="project-mint"><a href="https://solscan.io/token/${p.token_mint}" target="_blank">${p.token_mint}</a></div></div>`).join('');
    }

    function addToLiveFeed(burn) {
      const body = document.getElementById('live-burns-body');
      if (body.querySelector('.empty-state')) body.innerHTML = '';
      const row = document.createElement('tr');
      row.className = 'burn-new';
      row.innerHTML = `<td>${burn.token_ticker || burn.token_name || 'Unknown'}</td><td>${formatNumber(burn.tokens_burned)}</td><td>${parseFloat(burn.sol_spent || 0).toFixed(3)}</td><td>${timeAgo(burn.created_at)}</td><td><a href="https://solscan.io/tx/${burn.burn_signature}" target="_blank">View</a></td>`;
      body.insertBefore(row, body.firstChild);
      while (body.children.length > 10) body.removeChild(body.lastChild);
    }

    function formatNumber(n) { if (n >= 1e9) return (n/1e9).toFixed(2)+'B'; if (n >= 1e6) return (n/1e6).toFixed(2)+'M'; if (n >= 1e3) return (n/1e3).toFixed(2)+'K'; return n?.toFixed(0) || '0'; }
    function timeAgo(d) { const s = Math.floor((new Date() - new Date(d)) / 1000); if (s < 60) return s+'s ago'; if (s < 3600) return Math.floor(s/60)+'m ago'; if (s < 86400) return Math.floor(s/3600)+'h ago'; return Math.floor(s/86400)+'d ago'; }

    document.getElementById('register-form').addEventListener('submit', async e => {
      e.preventDefault();
      const btn = e.target.querySelector('button');
      btn.disabled = true; btn.textContent = 'Registering...';
      try {
        const res = await fetch('/api/register', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ tokenMint: document.getElementById('token-mint').value, tokenName: document.getElementById('token-name').value, tokenTicker: document.getElementById('token-ticker').value, creatorWallet: document.getElementById('owner-wallet').value }) });
        const data = await res.json();
        if (data.depositAddress) { document.getElementById('deposit-address').textContent = data.depositAddress; document.getElementById('success-box').classList.add('show'); loadDashboard(); }
        else alert(data.error || 'Registration failed');
      } catch (err) { alert('Error: ' + err.message); }
      btn.disabled = false; btn.textContent = 'Receive Your Deposit Address';
    });

    function copyAddress() { navigator.clipboard.writeText(document.getElementById('deposit-address').textContent); event.target.textContent = 'Copied!'; setTimeout(() => event.target.textContent = 'Copy', 2000); }

    loadDashboard();
    setInterval(loadDashboard, 5000);
  </script>
</body>
</html>
